CSE508: Network Security, Spring 2024
Homework 1: Passive Network Monitoring
Student Name: Santa Maria Shithil
SBU ID: 115074486
-------------------------------------------------------------------------------

1. Network traffic analysis with tcpdump

 1.1 How many packets does the trace contain?
     Answer: 32616
     Command used: tcpdump -n -r hw1.pcap | wc -l
 
 1.2 How many ARP packets and how many UDP packets?
     Part1: How many ARP packets?
          Answer: 11304
          Command Used: tcpdump -n -r hw1.pcap arp|wc -l
     Part2: How many UDP packets?
          Answer: 18334
          Command Used: tcpdump -n -r hw1.pcap udp| wc -l

 1.3 How many DHCP packets?
     Answer: 256
     Command Used: tcpdump -r hw1.pcap -n 'udp and (port 67 or port 68)' | wc -l
 
 1.4 How many packets were exchanged between 91.189.90.41 and 192.168.0.200?
     Answer: 14
     Command Used1: tcpdump -n -r hw1.pcap "(ip src 91.189.90.41 or ip src 192.168.0.200) and (ip dst 192.168.0.200 or ip dst 91.189.90.41)" | wc -l
     Command Used2: tcpdump -n "(ip src 192.168.0.200 and ip dst 91.189.90.41) or (ip src 91.189.90.41 and ip dst 192.168.0.200)" -r hw1.pcap | wc -l
 
 1.5 Print the unique source IP addresses found in the trace in numerical
     order.
     Answer: 
     0.0.0.0
     1.234.31.20
     46.51.197.88
     46.51.197.89
     62.252.170.81
     62.252.170.91
     87.98.246.8
     87.230.23.162
     91.189.88.33
     91.189.89.88
     91.189.90.40
     91.189.90.41
     91.189.91.14
     91.189.91.15
     91.189.92.190
     92.240.68.152
     122.154.101.54
     130.75.16.5
     159.148.96.184
     169.254.56.55
     192.168.0.1
     192.168.0.2
     192.168.0.3
     192.168.0.5
     192.168.0.6
     192.168.0.7
     192.168.0.10
     192.168.0.11
     192.168.0.12
     192.168.0.200
     194.168.4.100
     216.137.63.121
     216.137.63.137
     Command Used: tcpdump -r hw1.pcap -n ip| awk '{print $3}' | cut -d '.' -f 1-4 | sort -t '.' -k 1,1n -k 2,2n -k 3,3n -k 4,4n | uniq

 1.6 Print the unique 'private network' (according to RFC1918) source IP
     addresses found in the trace in numerical order.
     Answer:
     192.168.0.1
     192.168.0.2
     192.168.0.3
     192.168.0.5
     192.168.0.6
     192.168.0.7
     192.168.0.10
     192.168.0.11
     192.168.0.12
     192.168.0.200
     Command Used: tcpdump -r hw1.pcap -nn ip| awk '{print $3}' | cut -d '.' -f 1-4 | sort -t '.' -k 1,1n -k 2,2n -k 3,3n -k 4,4n | uniq| grep -E '^(10\.|172\.(1[6-9]|2[0-9]|3[0-1])\.|192\.168\.)'
 
 1.7 Print the unique destination IP addresses found in the trace in numerical
     order.
     Answer:
     1.234.31.20
     46.51.197.88
     46.51.197.89
     62.252.170.81
     62.252.170.91
     87.98.246.8
     87.230.23.162
     91.189.88.33
     91.189.89.88
     91.189.90.40
     91.189.90.41
     91.189.91.14
     91.189.91.15
     91.189.92.190
     92.240.68.152
     122.154.101.54
     130.75.16.5
     159.148.96.184
     169.254.255.255
     192.168.0.12
     192.168.0.200
     192.168.0.255
     194.168.4.100
     216.137.63.121
     216.137.63.137
     224.0.0.22
     224.0.0.251
     224.0.0.252
     239.255.255.250
     255.255.255.255
     Command Used1: tcpdump -r hw1.pcap -n ip | awk '{print $5}' | cut -d ':' -f 1 | cut -d '.' -f 1-4| sort -t '.' -k 1,1n -k 2,2n -k 3,3n -k 4,4n | uniq
     

 1.8 What are the top-5 TCP and top-5 UDP destination ports?
     Part1: What are the top-5 TCP ports?
          Answer: 
          727 80
          697 54634
          346 49836
          61 47110
          36 40341
          Here first column represents the frequency and the second column represents the ports. So, top 5 tcp ports are 80, 54634, 49836, 47110, 
          and 40342. 
          Command Used: tcpdump -n -r hw1.pcap tcp  | awk '{print $5}' | cut -d '.' -f 5| cut -d ':' -f 1|sort| uniq -c|sort -nr| head -5

     Part2: What are the top-5 UDP destination ports?
          Answer:
          13178 1900
          1925 137
          1516 5355
          840 5353
          399 138
          Similarly, first column represents the frequency and the second column represents the ports. So, top 5 tcp ports are 1900, 137, 5355, 5353, 
          and 138.
          Command Used: tcpdump -n -r hw1.pcap udp| awk '{print $5}' | cut -d '.' -f 5| cut -d ':' -f 1|sort| uniq -c|sort -nr| head -5
 
 1.9 How many TCP packets have the SYN flag set?
     Answer: 75
     Command Used1: tcpdump -n -r hw1.pcap 'tcp[tcpflags] & tcp-syn != 0' | wc -l
     Command Used2: tcpdump -n -r hw1.pcap '(tcp[13] & 2) == 2' | wc -l

1.10 How many TCP connection attempts were made?
     Answer: 37
     Command Used1: tcpdump -n -r hw1.pcap 'tcp[13] == 2' | wc -l 
     Command Used2:  tcpdump -n -r hw1.pcap 'tcp[tcpflags] == tcp-syn' | wc -l
 
1.11 Towards which ports were TCP connection attempts made? How many attempts
     per port?
     Part1: Towards which ports were TCP connection attempts made?
          Answer:
          443
          465
          80
          9100
          Command Used: tcpdump -n -r hw1.pcap 'tcp[13] == 2'| awk '{print $5}' | cut -d '.' -f 5|cut -d ':' -f 1| sort| uniq 

     Part2: How many attempts per port?
          Answer: 
          1 443
          1 465
          33 80
          2 9100
          Here first column represents the number of attempts and the second column represents the 
          port number. 
          Command: tcpdump -n -r hw1.pcap 'tcp[13] == 2'| awk '{print $5}' | cut -d '.' -f 5|cut -d ':' -f 1| sort| uniq -c
 
1.12 How many HTTP GET requests were made? Print the URLs of all HTTP requests
     for JPG files.

1.13 When (date and time) was the first and last packet of the trace sent?

1.14 What is the brand of the device that sent most of the packets? What is its
     IP address?

1.15 Report the distribution of Ethernet packet sizes (how many packets of size
     X exist in the trace, for all values of X in the trace), numerically
     sorted by packet size.


2. What to submit

An plain ASCII text file with the answers to the above questions, along with
the command/script/approach used to find them.
